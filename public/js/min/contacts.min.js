!function(a,b){function c(){this.$personal=a(".personal.contacts"),this.$personal_contacts=a("#personal_contacts"),this.$add=a("#add",this.$personal_contacts),this.$add_connect_user=a("#add_connect_user",this.$personal_contacts),this.$connect_list=a("#connect",this.$personal_contacts),this.$mobilePhone=a("#mobile_phone",this.$personal_contacts),this.$addMobilePhoneTd=a("#add_mobile_phone_td",this.$personal_contacts),this.connectLabelFull={skype:"Skype",icq:"ICQ",free_lance:"Free-lance",my_circle:"Мой круг",linkedln:"Linkedln",facebook:"Facebook",live_journal:"LiveJournal",other_site:"Другой сайт"},this.connectLabel={}}c.prototype.setConnectionLabel=function(){var b=this;a("p[data-connect]",this.$add_connect_user).each(function(c,d){a(d).data("connect")in b.connectLabelFull&&(b.connectLabel[a(d).data("connect")]=b.connectLabelFull[a(d).data("connect")])})},c.prototype.validateForm=function(){a("#personal_contacts").validate({rules:{email:{required:!0,email:!0}},messages:{email:{required:"Это поле обязательно для заполнения",email:"Не коректный email"}}})},c.prototype.messageColor=function(){a("span.required",this.$personal_contacts).filter(function(){return a(this).text()}).parent().parent().find("input[type=tel]").css("border","1px red solid")},c.prototype.addEventListenerAddConnect=function(){this.$add.on("click",{self:this},function(a){a.data.self.$connect_list.slideToggle(200),a.stopPropagation()})},c.prototype.addEventListenerConnect=function(){this.$personal.on("click",{self:this},function(a){a.data.self.$connect_list.hide()})},c.prototype.addEventListenerList=function(){this.$connect_list.on("click",{self:this},function(c){var d=a(c.target).data("connect");if(c.data.self.connectLabel[d]){a(c.target).remove();var e=a("#contacts_list").html(),f=Handlebars.compile(e),g=f({name:d,label:c.data.self.connectLabel[d],BASE_URL:b});c.data.self.$add_connect_user.parent().before(g),delete c.data.self.connectLabel[d],0===Object.keys(c.data.self.connectLabel).length&&c.data.self.$add_connect_user.remove()}else c.stopPropagation()})},c.prototype.maskedInputInit=function(){a("#mobile_phone").mask("375 (99) 999-99-99"),a("#work_phone").mask("375 (99) 999-99-99"),a("#mobile_phone_other").mask("375 (99) 999-99-99"),a("#home_phone").mask("375 (99) 999-99-99")},c.prototype.addEventListenerMobilePhone=function(){this.$mobilePhone.val()&&this.$addMobilePhoneTd.show(),this.$mobilePhone.on("keydown change blur",{self:this},function(c){var d=a(this);d.val()&&"375 (__) ___-__-__"!==d.val()&&!/_/.test(d.val())?c.data.self.$addMobilePhoneTd.fadeIn(500):(c.data.self.$addMobilePhoneTd.hide(),a('tr[data-mobile-phone="delete"]').remove(),c.data.self.$addMobilePhoneTd.removeClass("delete_phone"),a("#add_mobile_phone",c.data.self.$addMobilePhoneTd).html('&nbsp;&nbsp;<img src="'+b+'/public/img/add.png">&nbsp;&nbsp;Дополнительный&nbsp;мобильный&nbsp;телефон').css({color:"green"}))})},c.prototype.addEventListenerMobilePhoneTd=function(){this.$addMobilePhoneTd.on("click",{self:this},function(){if(a(this).hasClass("delete_phone"))a('tr[data-mobile-phone="delete"]').remove(),a(this).removeClass("delete_phone"),a("#add_mobile_phone",a(this)).html('&nbsp;&nbsp;<img src="'+b+'/public/img/add.png">&nbsp;&nbsp;Дополнительный&nbsp;мобильный&nbsp;телефон').css({color:"green"});else{var c=a("#tr-template-mobilePhone").html(),d=Handlebars.compile(c),e=d({BASE_URL:b});a(this).after(e),a("#mobile_phone_other").mask("375 (99) 999-99-99"),a(this).addClass("delete_phone"),a("#add_mobile_phone",a(this)).html('&nbsp;&nbsp;<img src="'+b+'/public/img/delete.png">&nbsp;&nbsp;Удалить&nbsp;мобильный&nbsp;телефон').css({color:"red"})}})},c.prototype.init=function(){this.maskedInputInit(),this.setConnectionLabel(),this.addEventListenerMobilePhone(),this.addEventListenerMobilePhoneTd(),this.validateForm(),this.addEventListenerConnect(),this.addEventListenerAddConnect(),this.addEventListenerList(),this.messageColor()};var d=new c;d.init()}(jQuery,BASE_URL,window);